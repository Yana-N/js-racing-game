document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector(".score"),t=document.querySelector(".start"),o=document.querySelector(".game-area"),n=document.querySelector(".audio-btn");o.style.height=100*Math.floor(document.documentElement.clientHeight/100)+"px";const s=document.createElement("div");s.classList.add("car");const r=document.createElement("audio");r.src="../audio/audio.mp3",r.loop=!0;const d=document.createElement("audio");d.src="../audio/crash.mp3";const a={ArrowUp:!1,ArrowDown:!1,ArrowLeft:!1,ArrowRight:!1},c={start:!1,score:0,speed:5,traffic:3};function i(e){return o.offsetHeight/e+1}function l(){n.classList.toggle("active")}function f(){c.start&&(c.score+=c.speed,e.textContent="Score: "+c.score,document.querySelectorAll(".line").forEach((function(e){e.y+=c.speed,e.style.top=e.y+"px",e.y>=o.offsetHeight&&(e.y=-100)})),document.querySelectorAll(".enemy").forEach((function(n){let a=s.getBoundingClientRect(),i=n.getBoundingClientRect();a.top<=i.bottom&&a.right>=i.left&&a.left<=i.right&&a.bottom>=i.top&&(c.start=!1,t.classList.remove("hide"),e.style.top=t.offsetHeight,r.pause(),d.play(),l()),n.y+=c.speed/2,n.style.top=n.y+"px",n.y>=o.offsetHeight&&(n.y=-100*c.traffic,n.style.left=Math.floor(Math.random()*(o.offsetWidth-n.offsetWidth))+"px")})),a.ArrowLeft&&c.x>0&&(c.x-=c.speed),a.ArrowRight&&c.x<o.offsetWidth-s.offsetWidth&&(c.x+=c.speed),a.ArrowUp&&c.y>0&&(c.y-=c.speed),a.ArrowDown&&c.y<o.offsetHeight-s.offsetHeight&&(c.y+=c.speed),s.style.left=c.x+"px",s.style.top=c.y+"px",requestAnimationFrame(f))}t.addEventListener("click",(function(){t.classList.add("hide"),n.classList.add("active"),o.innerHTML="";for(let e=0;e<i(100);e++){const t=document.createElement("div");t.classList.add("line"),t.style.top=100*e+"px",t.y=100*e,o.appendChild(t)}for(let e=0;e<i(100*c.traffic);e++){const t=document.createElement("div"),n=Math.floor(5*Math.random()+1);t.classList.add("enemy"),t.y=-100*c.traffic*(e+1),t.style.top=t.y+"px",t.style.left=Math.floor(Math.random()*(o.offsetWidth-t.offsetWidth))+"px",t.style.background=`transparent url("../images/dest/enemy/${n}.png") no-repeat center / contain`,o.appendChild(t)}c.score=0,c.start=!0,o.appendChild(s),document.body.appendChild(r),r.play(),s.style.left=o.offsetWidth/2-s.offsetWidth/2+"px",s.style.top="auto",s.style.bottom="10px",c.x=s.offsetLeft,c.y=s.offsetTop,requestAnimationFrame(f)})),document.addEventListener("keydown",(function(e){e.preventDefault(),a[e.key]=!0})),document.addEventListener("keyup",(function(e){e.preventDefault(),a[e.key]=!1})),n.addEventListener("click",()=>{l(),r.paused?r.play():r.pause()})}));